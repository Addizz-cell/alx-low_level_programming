More function nested loops to learn in here
